const ACCEPTED_COOKIES = "ACCEPTED_COOKIES";
const PREF_FUNCTIONALITY = "PREF_FUNCTIONALITY";
const PREF_PERFORMANCE = "PREF_PERFORMANCE";
const PREF_MARKETING = "PREF_MARKETING";
const COOKIE_DISMISS = "purecookieDismiss";
const Y = "Y"
const N = "N"

function setCookie(name, value) {
    var expires = "";
    var date = new Date();
    date.setTime(date.getTime() + (cookieDays * 24 * 60 * 60 * 1000));
    expires = "; expires=" + date.toUTCString();
    let domain = name == COOKIE_DISMISS ? "domain=.petsure.com" : "";

    if(!isDev) {
        document.cookie = name + "=" + (value || "") + expires + "; path=/; SameSite=None; Secure;" + domain;
    } else {
        document.cookie = name + "=" + (value || "") + expires + "; path=/;";
    }
}

function setCookieForMinutes(name, value, minutes) {
    var expires = "";
    var date = new Date();
    date.setTime(date.getTime() + (minutes * 60 * 1000));
    expires = "; expires=" + date.toUTCString();
    if(!isDev) {
        document.cookie = name + "=" + (value || "") + expires + "; path=/; SameSite=None; Secure;";
    } else {
        document.cookie = name + "=" + (value || "") + expires + "; path=/;";
    }
}

function getCookie(name) {
    var nameEQ = name + "=";
    var ca = document.cookie.split(';');
    for (var i = 0; i < ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0) == ' ') c = c.substring(1, c.length);
        if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);
    }
    return null;
}

function eraseCookie(name) {
    if(!isDev) {
        document.cookie = name + "=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT; SameSite=None; Secure;";
    } else {
        document.cookie = name +  "=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;";
    }
}

function eraseCookieByDomainAndPath(name, domain, path = '/') {
    if(!isDev) {
        document.cookie = name + "=; Path="+path+"; Expires=Thu, 01 Jan 1970 00:00:01 GMT; SameSite=None; Secure; domain="+domain;
    } else {
        document.cookie = name +  "=; Path="+path+"; Expires=Thu, 01 Jan 1970 00:00:01 GMT;domain="+domain;
    }
}

function deleteSecureCookies(){
    const replaceNames = {
        personReference : "r1",
        quoteReference : "r2",
        confirm: "confirm",
        paymentType: "paymentType",
        paymentFail: "paymentFail",
        isOptOutAutoRenewal: "isOptOutAutoRenewal",
        healthComplete: "healthComplete",
        messageCode: "messageCode",
        hashCode: "hashCode",
        selectedflow: "selectedflow",
        fromAddOther: "fromAddOther",
        editPet: "editPet",
        fromSummary: "fromSummary",
        hasChangedPetType: "hasChangedPetType",
        monthlyPayment: "monthlyPayment"
    }
    for(let i=0;i < secureParams.length;i++){
        if(!isDev) {
            document.cookie = replaceNames[secureParams[i]] + "=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT; SameSite=None; Secure;";
        } else {
            document.cookie = replaceNames[secureParams[i]] +  "=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;";
        }
    }
}

function deleteCookiesByDomain(cookieList, domain) {
    var ca = document.cookie.split(';');
    let co = {};

    for (var i = 0; i < ca.length; i++){
        let indexOfEQ = ca[i].indexOf('=')
        co[ca[i].substring(0, indexOfEQ).trim()] = ca[i].substring(indexOfEQ+1, ca[i].length)
    }

    cookieList.forEach(cookie => {
        if (co[cookie]){
            eraseCookieByDomainAndPath(cookie, domain)
        }
    })

}

(function() {
    if (cookiesToBeDeleted.length != 0 && domainListToDeleteCookies.length != 0 ) {
        domainListToDeleteCookies.forEach(domain => {
            deleteCookiesByDomain(cookiesToBeDeleted, domain.trim())
        })
    }
})();
