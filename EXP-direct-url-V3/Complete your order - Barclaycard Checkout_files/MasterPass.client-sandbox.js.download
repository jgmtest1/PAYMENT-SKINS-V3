(function(){function b(d){return d instanceof Array;}function c(d){return typeof d==="function";}function a(d){return typeof d==="string"||d instanceof String;}window.MasterPass=window.MasterPass||{};MasterPass.client=(function(){var e;var d;var p;var ac;var Z;var L;var z;var F;var V;var n=!!window.postMessage;var m=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"");var R="https://sandbox.masterpass.com/switchui/index.html";var s=false;var U="https://sandbox.masterpass.com";var O="https://sandbox.static.masterpass.com/dyn/img/btn/en/US/mp_chk_btn_147x034px.png";var f="Buy with MasterPass";var J="https://sandbox.static.masterpass.com/lightbox/version1474573220890/Switch/integration/MasterPass.connect.png";var S="Connect with MasterPass";var I=false;var r=false;function P(ae){if(!ae){return null;}return ae.replace(/([^-A-Za-z0-9+&@#/%?=~_|!:,.;\(\)])|(javascript:)/g,"");}function aa(ae,af){var ag={};if(b(af.allowedCardTypes)){ag.allowedCardTypes=af.allowedCardTypes;}else{if(a(af.allowedCardTypes)){ag.allowedCardTypes=[af.allowedCardTypes];}}if(b(af.allowedLoyaltyPrograms)){ag.allowedLoyaltyPrograms=af.allowedLoyaltyPrograms;}else{if(a(af.allowedLoyaltyPrograms)){ag.allowedLoyaltyPrograms=[af.allowedLoyaltyPrograms];}}if(b(af.allowedShipToCountries)){ag.allowedShipToCountries=af.allowedShipToCountries;}else{if(a(af.allowedShipToCountries)){ag.allowedShipToCountries=[af.allowedShipToCountries];}}if(a(af.shippingLocationProfile)){ag.shippingLocationProfile=af.shippingLocationProfile;}if(af.callbackUrl){ag.callbackUrl=P(af.callbackUrl);}if(af.returnUrl){ag.merchant_return_url=P(af.returnUrl);}if(n){if(c(af.failureCallback)){ag.failureCallback=af.failureCallback;}if(c(af.successCallback)){ag.successCallback=af.successCallback;}if(ag.failureCallback||ag.successCallback){ag.enhancedCallback=true;}if(c(af.cancelCallback)){ag.cancelCallback=af.cancelCallback;}}ag.flow=ae;if(af.locale){ag.locale=af.locale;var ah=af.locale.split("-");if(ah.length===1){ag.locale=af.locale;}else{ag.locale=ah[0]+"-"+ah[1].toUpperCase();}}if(af.merchantCheckoutId){ag.merchantCheckoutId=af.merchantCheckoutId;}if(af.precheckoutTransactionId){ag.precheckoutTransactionId=af.precheckoutTransactionId;}if(af.cardId&&ae==="checkout"){ag.cardId=af.cardId;}if(af.loyaltyEnabled&&ae==="checkout"){ag.loyaltyEnabled=af.loyaltyEnabled;}if(ae==="checkout"){if(af.walletId){ag.merchantId=af.walletId;}else{if(af.walletName){ag.merchantId=af.walletName;}}}if(af.suppressShippingAddressEnable&&ae==="checkout"){ag.suppressShippingAddressEnable=af.suppressShippingAddressEnable;}if(af.loyaltyId){ag.loyaltyId=af.loyaltyId;}if(af.shippingId){ag.shippingId=af.shippingId;}if(af.requestBasicCheckout){ag.requestBasicCheckout=true;}if(b(af.requestedDataTypes)){ag.requestedDataTypes=af.requestedDataTypes;}else{if(a(af.requestedDataTypes)){ag.requestedDataTypes=[af.requestedDataTypes];}}if(af.requestExpressCheckout){ag.requestExpressCheckout=true;}if(af.requestPairing||ae==="connect"){ag.requestPairing=true;}if(af.requestToken){ag.requestToken=af.requestToken;}if(af.version){ag.version=af.version;}if(af.pairingRequestToken){ag.pairingRequestToken=af.pairingRequestToken;if(ae==="connect"){ag.requestToken=af.pairingRequestToken;}}if(af.silentPairing){ag.silentPairing=af.silentPairing;}if(af.requireShippingDestination===false){ag.requireShippingDestination=false;}else{if(ae==="checkout"){ag.requireShippingDestination=true;}}ag.clientOrigin=m;ag.targetOrigin=m;if(af.walletId){ag.walletId=af.walletId;}if(af.walletName){ag.walletId=af.walletName;}if(af.consumerWalletId&&(ae==="checkout"||ae==="card-security"||ae==="add-shipping-address"||ae==="add-payment-method"||ae==="add-loyalty-program")){ag.consumerWalletId=af.consumerWalletId;}ac=ag;return ag;}function H(af){var ag=[];for(var ae in af){if(af.hasOwnProperty(ae)){if(b(af[ae])){ag.push(ae+"="+encodeURIComponent(af[ae].join(",")));}else{if(!c(af[ae])){ag.push(ae+"="+encodeURIComponent(af[ae]));}}}}return"?"+ag.join("&");}function j(ae){p=R+H(ae);if(L){return ae.failureCallback();}if(r){return w(false);}u();q(ae);document.getElementsByTagName("body")[0].className+=" MasterPass_modal-open";L=true;}function u(){if(!I){document.getElementsByTagName("head")[0].appendChild(T());I=true;}}function E(aj,ak){var ag;var am=new XMLHttpRequest();var af=10000;var ai=setTimeout(ah,af);function ae(an){var ap=new RegExp("(((http|https)+://[^/]+)[:]*[0-9]*)+/");var ao=ap.exec(an);if(ao&&ao.length>1){return ao[1];}return an;}function al(){var ar;var ao="/clientapi/switchapi/public/v6/variant/"+aj;var aq="/wallet/clientapi/walletapi/public/v6/variant/"+aj;var ap=/wallet/;var an=ae(window.location.href);if(ap.test(an)){return an+aq;}return an+ao;}function ah(){w(true);}am.open("GET",al());am.onload=function(){if(am.status===200){ag=JSON.parse(am.responseText);clearTimeout(ai);if(ag.variantId.toLowerCase()==="parity"&&ag.bundleId.toLowerCase()==="parity"){return w(true);}return w(false);}else{console.error("Error - xhr status: ",am.status);return w(true);}};am.onerror=function(an){console.error("Error on canary service: ",an);w(false);};am.send();}function t(ae){var af=["register","manage","view-wallets"];return(af.indexOf(ae)!==-1);}function w(ae){if(ae){V=x();document.body.appendChild(V);d=i(p);return document.body.appendChild(d);}window.location=p;}function q(ae){if(!window.postMessage||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i)||(navigator.userAgent.match(/Android/i)&&navigator.userAgent.match(/Mobile/i))){w(false);}else{if(ae.locale&&t(ae.flow)){E(ae.locale,w);}else{w(true);}}W();}function T(){var ae=document.createElement("link");ae.setAttribute("rel","stylesheet");ae.setAttribute("href","https://sandbox.static.masterpass.com/dyn/js/switch/integration/MasterPass.client.css");return ae;}function x(){var ae=document.createElement("div");ae.id="MasterPass_overlay";return ae;}function i(ag){var af=document.createElement("div");af.id="MasterPass_container";var ae='<iframe id="MasterPass_frame" name="MasterPass_frame" allowTransparency="true" frameborder="0" src="'+ag+'"></iframe>';af.innerHTML=ae;return af;}function h(){D();}function W(){if(s||!n){return;}if(window.addEventListener){window.addEventListener("message",g,false);}else{if(window.attachEvent){window.attachEvent("onmessage",g);}}s=true;}function ad(){if(window.removeEventListener){window.removeEventListener("message",g,false);}else{if(window.detachEvent){window.detachEvent("onmessage",g);}}s=false;}function D(){B();ad();L=false;}function B(){document.body.removeChild(d);document.body.removeChild(V);document.getElementsByTagName("body")[0].className=document.getElementsByTagName("body")[0].className.split(" MasterPass_modal-open").join("");}function o(ae){j(aa("register",ae));}function X(ae){j(aa("manage",ae));}function M(ae){j(aa("checkout",ae));}function y(ae){j(aa("connect",ae));}function C(ae){j(aa("add-payment-method",ae));}function A(ae){j(aa("add-shipping-address",ae));}function v(ae){j(aa("card-security",ae));}function Y(ae){j(aa("view-wallets",ae));}function G(af){var ae=N(af.element);ae.onclick=function(ah){M(af);ah=ah||window.event;ah.preventDefault?ah.preventDefault():ah.returnValue=false;};var ag=document.getElementById(af.element);ag.appendChild(ae);}function N(ae){var af=document.createElement("div");var ag='<div><img src="'+O+'" alt="'+f+'"/></div>';af.innerHTML='<a href="#">'+ag+"</a>";return af;}function ab(ae){var ag=K(ae.element);ag.onclick=function(ah){y(ae);ah=ah||window.event;ah.preventDefault?ah.preventDefault():ah.returnValue=false;};var af=document.getElementById(ae.element);af.appendChild(ag);}function l(ae){if(ae.origin){return ae.origin;}if(ae.originalEvent&&ae.originalEvent.origin){return ae.originalEvent.origin;}if(ae.uri){return getLocation(ae.uri);}if(ae.originalEvent&&ae.originalEvent.uri){return ae.originalEvent.uri;}if(ae.domain){return location.protocol+"//"+ae.domain;}if(ae.originalEvent&&ae.originalEvent.domain){return location.protocol+"//"+ae.originalEvent.domain;
}return;}function K(ae){var af=document.createElement("div");var ag='<div><img src="'+J+'" alt="'+S+'"/></div>';af.innerHTML='<a href="#">'+ag+"</a>";return af;}function Q(){F=document.querySelector("meta[name=viewport]");var ae=document.createElement("meta");ae.name="viewport";ae.content="width=device-width, height=device-height, user-scalable=no, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0";document.getElementsByTagName("head")[0].appendChild(ae);document.body.style.overflowY="hidden";}function k(){var ae=document.querySelector("meta[name=viewport]");if(!ae||!F){return;}ae.parentNode.removeChild(ae);document.getElementsByTagName("head")[0].appendChild(F);document.body.style.overflowY="auto";}function g(af){var ag;var ap;var am=l(af);if(am===U){try{ap=JSON.parse(af.data);}catch(ak){return;}ag=true;if(ap.mpstatus==="success"&&ac.successCallback){ac.successCallback(ap);}else{if(ap.mpstatus==="failure"){if(ac.failureCallback){ac.failureCallback(ap);}}else{if(ap.mpstatus==="cancel"){if(ac.cancelCallback){ac.cancelCallback(ap);}}else{if(ap.mpstatus==="originRequest"){var ah=af.source;var ai={status:"originResponse"};var aj=function(){setTimeout(function(){ah.postMessage(JSON.stringify(ai),am);},10);};if(self===top){aj();}else{ai.incomplete=true;aj();}ag=false;}else{if(ac.callbackUrl){var ao=[];var al;var ae=ac.callbackUrl;for(var an in ap){if(ap.hasOwnProperty(an)){ao.push(encodeURIComponent(an)+"="+encodeURIComponent(ap[an]));}}ag=false;al=ao.join("&");ae+=((ae.indexOf("?")!==-1)?"&":"?")+al;window.location=ae;}}}}}if(ag){k();D();return;}Q();}}W();return{addPaymentMethod:C,addShippingAddress:A,cardSecurity:v,checkout:M,checkoutButton:G,connect:y,connectButton:ab,manage:X,register:o,viewWallets:Y};})();}());